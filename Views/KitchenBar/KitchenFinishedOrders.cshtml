@model List<ChapeauPOS.Models.Order>
@{
	ViewData["Title"] = "Kitchen - Finished Orders";
}

<div style="margin:0;display:flex;justify-content:center;">
    <a href="/KitchenBar/KitchenFinishedOrders" class="btn btn-primary">Finished</a>
    <a href="/KitchenBar/KitchenRunningOrders" class="btn btn-primary">Running</a>
</div>

<div class="orders-container d-flex flex-row flex-wrap">
	@foreach (Order order in Model)
	{
		<div class="order-card m-2 p-3" style="width: 400px; border: 1px solid #ccc; border-radius: 8px; box-shadow: 2px 2px 5px rgba(0,0,0,0.1);">
			<!-- Header -->
			<div class="order-header d-flex justify-content-between align-items-center mb-2">
				<div class="badge bg-warning text-dark">Table @order.Table.TableNumber</div>
				<div class="text-end">
					<div class="fw-bold">@order.CreatedAt.ToString("hh:mm")</div>
					<small class="text-muted">@order.ClosedAt?.ToString("hh:mm")</small>
				</div>
			</div>

			<!-- Order Items -->
			@foreach (var courseGroup in order.OrderItems.OrderBy(oi => oi.MenuCourse).GroupBy(oi => oi.MenuCourse))
			{
				<div class="mb-3">
					<h6 class="border-bottom">@courseGroup.Key</h6>
					@foreach (OrderItem item in courseGroup)
					{
						<div class="d-flex justify-content-between align-items-start mb-2">
							<div>
								<strong>@item.Quantity x @item.MenuItem.ItemName</strong><br />
								@if (!string.IsNullOrEmpty(item.MenuItem.ItemDescription))
								{
									<small class="text-muted">@item.MenuItem.ItemDescription</small>
									<br />
								}
								@if (!string.IsNullOrEmpty(item.Notes))
								{
									<em class="text-muted small">@item.Notes</em>
								}
							</div>
							
						</div>
					}
				</div>
			}

			<!-- Order Status -->
			<div class="mb-2" style="text-align:center;background-color:grey;margin-top:30px;padding:10px;">
				<strong>Served</strong>
			</div>
		</div>
	}
</div>